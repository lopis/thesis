%!TEX root = ../thesis.tex
\section{Multiple Contract Net using Trust}

This scenario is similar to the previous one, but attempts to perform a better coverage of the features present in SAJaS. However. rather than comparing the exact value obtained from the simulation, the goal is to compare the overall behaviour of all agents.

\subsection{Experimental Setup}
This simulation is composed by multiple buyers and multiple sellers running simultaneously. After the sellers register themselves in the DF, each buyer will perform a search for sellers of the particular good it needs to purchase. Then, the buyer sends this list of agents to the CTAgent (CT standing for computational trust). The CTAgent will calculate a trust value for each seller based on its past contracts with buyers and return the top 5 sellers.

With this information, the buyer sends a CFP only to the 5 top agents and ACCEPT the best proposal from them. Some sellers will occasionally violate the contract after acceptance. The buyer will then inform the CTAgent if the contract was fulfilled or violated. The compilation of this composes the trust of the seller.

Some buyers are programmed to ignore trust and rely solely on the proposal. The idea is that informed buyers eventually avoid contacting sellers programmed to violate contracts more often. The goal of this experiment is to model this scenario in SAJaS, convert it to JADE and verify that the obtained results are very similar.

After one contract is concluded, Buyers start a new one, performing a new DF search for the next product they want to buy, request information from the CTAgent and issuing a new CFP.

\subsection{Results}

The experiment was executed 5 times in JADE and 5 times in SAJaS. The scenario is composed of 20 buyers using computational trust, 20 not using trust and 80 sellers. A total of 2000 contracts were recorded to create the following charts in Figures \ref{fig:enterprise_JADE} and \ref{fig:enterprise_SAJaS}. As shown, buyers who made use of computational trust had more successful contracts. The fluctuations early in the simulation are due to the initial lack of trust information.

As expected and as shown in the charts, the same outcome was observed both in JADE and SAJaS. With this experiment, it was possible to test the Request protocol - when requesting computational trust, the Contract Net - when purchasing goods, the Responder Dispatcher - to handle CFPs from multiple buyers concurrently, the messaging system and the DF service.

\begin{figure}[h]
	\centering
	\begin{tikzpicture}[scale=0.85]

		% horizontal axis
		\draw[->] (0,0) -- (11,0);
		\draw (5.5,-1.2) node[align=center] {Time/s}; %label

		% labels
		\draw	(1.4,0) node[anchor=north] {2}
				(2.8,0) node[anchor=north] {4}
				(4.2,0) node[anchor=north] {6}
				(5.6,0) node[anchor=north] {8}
				(7.1,0) node[anchor=north] {10}
				(8.5,0) node[anchor=north] {12}
				(9.9,0) node[anchor=north] {14};
		
		
		% vertical axis
		\draw[->] (0,0) -- (0,5);
		\draw (-1.1,2.5) node[rotate=90, anchor=south, align=center]
			{\% of Fullfielment}; %label
		\draw	(0, 1) node[anchor=east] {0.25}
				(0, 2) node[anchor=east] {0.50}
				(0, 3) node[anchor=east] {0.75}
				(0, 4) node[anchor=east] {1.00};
		
		

		%% Data %%

		%subtitle
		\draw[thick,thick] (0.5,3.5) --
			(1,3.5) node[anchor=west, pos=1.0] {Using trust and proposal};
		%line
		\input{chapters/charts/values_with_trust}

		\draw[thick, dotted]%subtitle
			(0.5,4.5) --
			(1,4.5) node[anchor=west, pos=1.0] {Using only the proposal}; 
		\input{chapters/charts/values_no_trust}


	\end{tikzpicture}
	\caption[Enterprise scenario results in JADE]
	{Average result after 5 executions of the Enterprise scenario in JADE}
	\label{fig:enterprise_JADE}
\end{figure}


\begin{figure}[h]
	\centering
	\begin{tikzpicture}[scale=0.85]

		% horizontal axis
		\draw[->] (0,0) -- (11,0);
		\draw (5.5,-1.2) node[align=center] {Time/s}; %label

		% labels
		\draw	(1.4,0) node[anchor=north] {1}
				(2.8,0) node[anchor=north] {2}
				(4.2,0) node[anchor=north] {3}
				(5.6,0) node[anchor=north] {4}
				(7.1,0) node[anchor=north] {5}
				(8.5,0) node[anchor=north] {6}
				(9.9,0) node[anchor=north] {7};
		
		
		% vertical axis
		\draw[->] (0,0) -- (0,5);
		\draw (-1.1,2.5) node[rotate=90, anchor=south, align=center]
			{\% of Fullfielment}; %label
		\draw	(0, 1) node[anchor=east] {0.25}
				(0, 2) node[anchor=east] {0.50}
				(0, 3) node[anchor=east] {0.75}
				(0, 4) node[anchor=east] {1.00};

		%% Data %%

		%subtitle
		\draw[thick,dotted] (0.5,3.5) --
			(1,3.5) node[anchor=west, pos=1.0] {Using trust and proposal};
		%line
		\input{chapters/charts/values_with_trust_sajas}

		\draw[thick] 
			%subtitle
			(0.5,4.5) --
			(1,4.5) node[anchor=west, pos=1.0] {Using only the proposal}; 
		\input{chapters/charts/values_no_trust_sajas}


	\end{tikzpicture}
	\caption[Enterprise scenario results in Repast]
	{Average result after 5 executions of the Enterprise scenario in Repast}
	\label{fig:enterprise_SAJaS}
\end{figure}